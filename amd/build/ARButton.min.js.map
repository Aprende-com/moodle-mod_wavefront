{"version":3,"sources":["../src/ARButton.js"],"names":["ARButton","renderer","sessionInit","button","document","createElement","showStartAR","domOverlay","overlay","style","display","body","appendChild","svg","createElementNS","setAttribute","position","right","top","addEventListener","currentSession","end","path","optionalFeatures","push","root","onSessionStarted","session","onSessionEnded","xr","setReferenceSpaceType","setSession","textContent","removeEventListener","cursor","left","width","onmouseenter","opacity","onmouseleave","onclick","navigator","requestSession","then","disableButton","showARNotSupported","stylizeElement","element","bottom","padding","border","borderRadius","background","color","font","textAlign","outline","zIndex","id","isSessionSupported","supported","catch","value","console","log","name","message","window","isSecureContext","href","location","replace","innerHTML","textDecoration"],"mappings":"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","sourcesContent":["class ARButton {\n\n\tstatic createButton( renderer, sessionInit = {} ) {\n\n\t\tconst button = document.createElement( 'button' );\n\n\t\tfunction showStartAR( /*device*/ ) {\n\n\t\t\tif ( sessionInit.domOverlay === undefined ) {\n\n\t\t\t\tvar overlay = document.createElement( 'div' );\n\t\t\t\toverlay.style.display = 'none';\n\t\t\t\tdocument.body.appendChild( overlay );\n\n\t\t\t\tvar svg = document.createElementNS( 'http://www.w3.org/2000/svg', 'svg' );\n\t\t\t\tsvg.setAttribute( 'width', 38 );\n\t\t\t\tsvg.setAttribute( 'height', 38 );\n\t\t\t\tsvg.style.position = 'absolute';\n\t\t\t\tsvg.style.right = '20px';\n\t\t\t\tsvg.style.top = '20px';\n\t\t\t\tsvg.addEventListener( 'click', function () {\n\n\t\t\t\t\tcurrentSession.end();\n\n\t\t\t\t} );\n\t\t\t\toverlay.appendChild( svg );\n\n\t\t\t\tvar path = document.createElementNS( 'http://www.w3.org/2000/svg', 'path' );\n\t\t\t\tpath.setAttribute( 'd', 'M 12,12 L 28,28 M 28,12 12,28' );\n\t\t\t\tpath.setAttribute( 'stroke', '#fff' );\n\t\t\t\tpath.setAttribute( 'stroke-width', 2 );\n\t\t\t\tsvg.appendChild( path );\n\n\t\t\t\tif ( sessionInit.optionalFeatures === undefined ) {\n\n\t\t\t\t\tsessionInit.optionalFeatures = [];\n\n\t\t\t\t}\n\n\t\t\t\tsessionInit.optionalFeatures.push( 'dom-overlay' );\n\t\t\t\tsessionInit.domOverlay = { root: overlay };\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tlet currentSession = null;\n\n\t\t\tasync function onSessionStarted( session ) {\n\n\t\t\t\tsession.addEventListener( 'end', onSessionEnded );\n\n\t\t\t\trenderer.xr.setReferenceSpaceType( 'local' );\n\n\t\t\t\tawait renderer.xr.setSession( session );\n\n\t\t\t\tbutton.textContent = 'STOP AR';\n\t\t\t\tsessionInit.domOverlay.root.style.display = '';\n\n\t\t\t\tcurrentSession = session;\n\n\t\t\t}\n\n\t\t\tfunction onSessionEnded( /*event*/ ) {\n\n\t\t\t\tcurrentSession.removeEventListener( 'end', onSessionEnded );\n\n\t\t\t\tbutton.textContent = 'START AR';\n\t\t\t\tsessionInit.domOverlay.root.style.display = 'none';\n\n\t\t\t\tcurrentSession = null;\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tbutton.style.display = '';\n\n\t\t\tbutton.style.cursor = 'pointer';\n\t\t\tbutton.style.left = 'calc(50% - 50px)';\n\t\t\tbutton.style.width = '100px';\n\n\t\t\tbutton.textContent = 'START AR';\n\n\t\t\tbutton.onmouseenter = function () {\n\n\t\t\t\tbutton.style.opacity = '1.0';\n\n\t\t\t};\n\n\t\t\tbutton.onmouseleave = function () {\n\n\t\t\t\tbutton.style.opacity = '0.5';\n\n\t\t\t};\n\n\t\t\tbutton.onclick = function () {\n\n\t\t\t\tif ( currentSession === null ) {\n\n\t\t\t\t\tnavigator.xr.requestSession( 'immersive-ar', sessionInit ).then( onSessionStarted );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcurrentSession.end();\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t\tfunction disableButton() {\n\n\t\t\tbutton.style.display = '';\n\n\t\t\tbutton.style.cursor = 'auto';\n\t\t\tbutton.style.left = 'calc(50% - 75px)';\n\t\t\tbutton.style.width = '150px';\n\n\t\t\tbutton.onmouseenter = null;\n\t\t\tbutton.onmouseleave = null;\n\n\t\t\tbutton.onclick = null;\n\n\t\t}\n\n\t\tfunction showARNotSupported() {\n\n\t\t\tdisableButton();\n\n\t\t\tbutton.textContent = 'AR NOT SUPPORTED';\n\n\t\t}\n\n\t\tfunction stylizeElement( element ) {\n\n\t\t\telement.style.position = 'absolute';\n\t\t\telement.style.bottom = '20px';\n\t\t\telement.style.padding = '12px 6px';\n\t\t\telement.style.border = '1px solid #fff';\n\t\t\telement.style.borderRadius = '4px';\n\t\t\telement.style.background = 'rgba(0,0,0,0.1)';\n\t\t\telement.style.color = '#fff';\n\t\t\telement.style.font = 'normal 13px sans-serif';\n\t\t\telement.style.textAlign = 'center';\n\t\t\telement.style.opacity = '0.5';\n\t\t\telement.style.outline = 'none';\n\t\t\telement.style.zIndex = '999';\n\n\t\t}\n\n\t\tif ( 'xr' in navigator ) {\n\n\t\t\tbutton.id = 'ARButton';\n\t\t\tbutton.style.display = 'none';\n\n\t\t\tstylizeElement( button );\n\n\t\t\tnavigator.xr.isSessionSupported( 'immersive-ar' ).then( function ( supported ) {\n\n\t\t\t\tsupported ? showStartAR() : showARNotSupported();\n\n\t\t\t} ).catch(function(value) {\n  \t\t\t\tconsole.log(value.name + \": \" + value.message);\n\t\t\t \tshowARNotSupported \n\t\t\t});\n\t\t\t\n\t\t\treturn button;\n\n\t\t} else {\n\n\t\t\tconst message = document.createElement( 'a' );\n\n\t\t\tif ( window.isSecureContext === false ) {\n\n\t\t\t\tmessage.href = document.location.href.replace( /^http:/, 'https:' );\n\t\t\t\tmessage.innerHTML = 'WEBXR NEEDS HTTPS'; // TODO Improve message\n\n\t\t\t} else {\n\n\t\t\t\tmessage.href = 'https://immersiveweb.dev/';\n\t\t\t\tmessage.innerHTML = 'WEBXR NOT AVAILABLE';\n\n\t\t\t}\n\n\t\t\tmessage.style.left = 'calc(50% - 90px)';\n\t\t\tmessage.style.width = '180px';\n\t\t\tmessage.style.textDecoration = 'none';\n\n\t\t\tstylizeElement( message );\n\n\t\t\treturn message;\n\n\t\t}\n\n\t}\n\n}\n\nexport { ARButton };\n"],"file":"ARButton.min.js"}