{"version":3,"sources":["../src/ar_renderer.js"],"names":["camera","scene","renderer","controller","onWindowResize","aspect","window","innerWidth","innerHeight","updateProjectionMatrix","setSize","animate","setAnimationLoop","render","init","stage","container","document","getElementById","console","log","THREE","Scene","PerspectiveCamera","light","HemisphereLight","position","set","add","WebGLRenderer","antialias","alpha","setPixelRatio","devicePixelRatio","xr","enabled","appendChild","domElement","ARButton","createButton","geometry","CylinderGeometry","rotateX","Math","PI","onSelect","material","MeshPhongMaterial","color","random","mesh","Mesh","applyMatrix4","matrixWorld","quaternion","setFromRotationMatrix","getController","addEventListener"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Encapsules the behavior for creating a Wavefront 3D model in Moodle.\n *\n * Manages the UI while operations are occuring, including rendering and manipulating the model.\n *\n * @module     mod_wavefront/ar_renderer\n * @class      ar_renderer\n * @package    mod_wavefront\n * @copyright  2022 Ian Wild\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      3.9\n */\n\nimport WebGL from 'mod_wavefront/WebGL';\nimport * as THREE from 'mod_wavefront/three';\nimport { MTLLoader } from 'mod_wavefront/MTLLoader';\nimport { OBJLoader } from 'mod_wavefront/OBJLoader';\nimport { OrbitControls } from 'mod_wavefront/OrbitControls';\nimport { ARButton } from 'mod_wavefront/ARButton';\nimport jQuery from 'jquery';\n\nlet camera, scene, renderer;\nlet controller;\n\nfunction onWindowResize() {\n\n\tcamera.aspect = window.innerWidth / window.innerHeight;\n\tcamera.updateProjectionMatrix();\n\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\n}\n\nfunction animate() {\n\n\trenderer.setAnimationLoop( render );\n\n}\n\nfunction render() {\n\n\trenderer.render( scene, camera );\n\n}\n\nexport const init = (stage) => {\n\n\tvar container = document.getElementById(stage);\n    console.log(container);\n\t\n\tscene = new THREE.Scene();\n\n\tcamera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.01, 20 );\n\n\tconst light = new THREE.HemisphereLight( 0xffffff, 0xbbbbff, 1 );\n\tlight.position.set( 0.5, 1, 0.25 );\n\tscene.add( light );\n\n\t//\n\n\trenderer = new THREE.WebGLRenderer( { antialias: true, alpha: true } );\n\trenderer.setPixelRatio( window.devicePixelRatio );\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\trenderer.xr.enabled = true;\n\tcontainer.appendChild( renderer.domElement );\n\n\t//\n\n\tcontainer.appendChild( ARButton.createButton( renderer ) );\n\n\t//\n\n\tconst geometry = new THREE.CylinderGeometry( 0, 0.05, 0.2, 32 ).rotateX( Math.PI / 2 );\n\n\tfunction onSelect() {\n\n\t\tconst material = new THREE.MeshPhongMaterial( { color: 0xffffff * Math.random() } );\n\t\tconst mesh = new THREE.Mesh( geometry, material );\n\t\tmesh.position.set( 0, 0, - 0.3 ).applyMatrix4( controller.matrixWorld );\n\t\tmesh.quaternion.setFromRotationMatrix( controller.matrixWorld );\n\t\tscene.add( mesh );\n\n\t}\n\n\tcontroller = renderer.xr.getController( 0 );\n\tcontroller.addEventListener( 'select', onSelect );\n\tscene.add( controller );\n\n\t//\n\n\twindow.addEventListener( 'resize', onWindowResize );\n\n    animate();\n};\n\n\t\t"],"file":"ar_renderer.min.js"}