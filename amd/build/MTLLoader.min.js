define ("mod_wavefront/MTLLoader",["exports","mod_wavefront/three"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.MTLLoader=void 0;function c(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){c=function(a){return typeof a}}else{c=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return c(a)}function d(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function e(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function f(a,b,c){if(b)e(a.prototype,b);if(c)e(a,c);return a}function g(a,b){if("function"!=typeof b&&null!==b){throw new TypeError("Super expression must either be null or a function")}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});if(b)h(a,b)}function h(a,b){h=Object.setPrototypeOf||function(a,b){a.__proto__=b;return a};return h(a,b)}function i(a){return function(){var b=m(a),c;if(l()){var d=m(this).constructor;c=Reflect.construct(b,arguments,d)}else{c=b.apply(this,arguments)}return j(this,c)}}function j(a,b){if(b&&("object"===c(b)||"function"==typeof b)){return b}return k(a)}function k(a){if(void 0===a){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return a}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(a){return!1}}function m(a){m=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return m(a)}var n=function(a){g(c,a);var e=i(c);function c(a){d(this,c);return e.call(this,a)}f(c,[{key:"load",value:function load(a,c,d,f){var g=this,h=""===this.path?b.LoaderUtils.extractUrlBase(a):this.path,i=new b.FileLoader(this.manager);i.setPath(this.path);i.setRequestHeader(this.requestHeader);i.setWithCredentials(this.withCredentials);i.load(a,function(b){try{c(g.parse(b,h))}catch(b){if(f){f(b)}else{console.error(b)}g.manager.itemError(a)}},d,f)}},{key:"setMaterialOptions",value:function setMaterialOptions(a){this.materialOptions=a;return this}},{key:"parse",value:function parse(a,b){for(var c=a.split("\n"),d={},e={},f=0,g;f<c.length;f++){g=c[f];g=g.trim();if(0===g.length||"#"===g.charAt(0)){continue}var h=g.indexOf(" "),j=0<=h?g.substring(0,h):g;j=j.toLowerCase();var l=0<=h?g.substring(h+1):"";l=l.trim();if("newmtl"===j){d={name:l};e[l]=d}else{if("ka"===j||"kd"===j||"ks"===j||"ke"===j){var m=l.split(/\s+/,3);d[j]=[parseFloat(m[0]),parseFloat(m[1]),parseFloat(m[2])]}else{d[j]=l}}}var k=new o(this.resourcePath||b,this.materialOptions);k.setCrossOrigin(this.crossOrigin);k.setManager(this.manager);k.setMaterials(e);return k}}]);return c}(b.Loader);a.MTLLoader=n;var o=function(){function a(){var c=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};d(this,a);this.baseUrl=c;this.options=e;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.crossOrigin="anonymous";this.side=this.options.side!==void 0?this.options.side:b.FrontSide;this.wrap=this.options.wrap!==void 0?this.options.wrap:b.RepeatWrapping}f(a,[{key:"setCrossOrigin",value:function setCrossOrigin(a){this.crossOrigin=a;return this}},{key:"setManager",value:function setManager(a){this.manager=a}},{key:"setMaterials",value:function setMaterials(a){this.materialsInfo=this.convert(a);this.materials={};this.materialsArray=[];this.nameLookup={}}},{key:"convert",value:function convert(a){if(!this.options)return a;var b={};for(var h in a){var c=a[h],d={};b[h]=d;for(var i in c){var e=!0,f=c[i],g=i.toLowerCase();switch(g){case"kd":case"ka":case"ks":if(this.options&&this.options.normalizeRGB){f=[f[0]/255,f[1]/255,f[2]/255]}if(this.options&&this.options.ignoreZeroRGBs){if(0===f[0]&&0===f[1]&&0===f[2]){e=!1}}break;default:break;}if(e){d[g]=f}}}return b}},{key:"preload",value:function preload(){for(var a in this.materialsInfo){this.create(a)}}},{key:"getIndex",value:function getIndex(a){return this.nameLookup[a]}},{key:"getAsArray",value:function getAsArray(){var a=0;for(var b in this.materialsInfo){this.materialsArray[a]=this.create(b);this.nameLookup[b]=a;a++}return this.materialsArray}},{key:"create",value:function create(a){if(this.materials[a]===void 0){this.createMaterial_(a)}return this.materials[a]}},{key:"createMaterial_",value:function createMaterial_(a){var e=this,f=this.materialsInfo[a],g={name:a,side:this.side};function c(a,b){if("string"!=typeof b||""===b)return"";if(/^https?:\/\//i.test(b))return b;return a+b}function d(a,d){if(g[a])return;var f=e.getTextureParams(d,g),h=e.loadTexture(c(e.baseUrl,f.url));h.repeat.copy(f.scale);h.offset.copy(f.offset);h.wrapS=e.wrap;h.wrapT=e.wrap;if("map"===a||"emissiveMap"===a){h.encoding=b.sRGBEncoding}g[a]=h}for(var j in f){var h=f[j],i=void 0;if(""===h)continue;switch(j.toLowerCase()){case"kd":g.color=new b.Color().fromArray(h).convertSRGBToLinear();break;case"ks":g.specular=new b.Color().fromArray(h).convertSRGBToLinear();break;case"ke":g.emissive=new b.Color().fromArray(h).convertSRGBToLinear();break;case"map_kd":d("map",h);break;case"map_ks":d("specularMap",h);break;case"map_ke":d("emissiveMap",h);break;case"norm":d("normalMap",h);break;case"map_bump":case"bump":d("bumpMap",h);break;case"map_d":d("alphaMap",h);g.transparent=!0;break;case"ns":g.shininess=parseFloat(h);break;case"d":i=parseFloat(h);if(1>i){g.opacity=i;g.transparent=!0}break;case"tr":i=parseFloat(h);if(this.options&&this.options.invertTrProperty)i=1-i;if(0<i){g.opacity=1-i;g.transparent=!0}break;default:break;}}this.materials[a]=new b.MeshPhongMaterial(g);return this.materials[a]}},{key:"getTextureParams",value:function getTextureParams(a,c){var d={scale:new b.Vector2(1,1),offset:new b.Vector2(0,0)},e=a.split(/\s+/),f;f=e.indexOf("-bm");if(0<=f){c.bumpScale=parseFloat(e[f+1]);e.splice(f,2)}f=e.indexOf("-s");if(0<=f){d.scale.set(parseFloat(e[f+1]),parseFloat(e[f+2]));e.splice(f,4)}f=e.indexOf("-o");if(0<=f){d.offset.set(parseFloat(e[f+1]),parseFloat(e[f+2]));e.splice(f,4)}d.url=e.join(" ").trim();return d}},{key:"loadTexture",value:function loadTexture(a,c,d,e,f){var g=this.manager!==void 0?this.manager:b.DefaultLoadingManager,h=g.getHandler(a);if(null===h){h=new b.TextureLoader(g)}if(h.setCrossOrigin)h.setCrossOrigin(this.crossOrigin);var i=h.load(a,d,e,f);if(c!==void 0)i.mapping=c;return i}}]);return a}()});
//# sourceMappingURL=MTLLoader.min.js.map
